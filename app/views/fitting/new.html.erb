<%= render 'sidebar' %>
<div class="main-content">
  <div class="container-fluid">
    <div class="row-fluid">
      <div class="area-top clearfix">
        <div class="pull-left header">
          <h3 class="title">Create a new fitting</h3>
        </div>
      </div>
    </div>
  </div>
  <div class="container-fluid padded">
    <div class="row-fluid">
      <div class="span4">
        <div class="accordion" id="ships" data-bind="template:{name:'group', foreach: groups}"></div>
      </div>
      <div class="span3">
        <%= simple_form_for @fitting, :url => url_for(:action => 'create', :controller => 'fitting'), :method => 'post' do |f| %>
          <%= f.input :name, label: 'Name of your fitting' %>
          <!-- ko with: selectedShip -->
          <%= f.input :ship_id, :as => :hidden, :input_html => { :data=>{:bind=>'value:id'}} %>
          <!-- /ko -->
          <%= f.button :submit %>
        <% end %>
      </div>
    </div>
  </div>
</div>
<script type="text/html" id="group">
<div class="accordion-group accordion accordion-slim">
  <div class="accordion-heading">
    <a class="accordion-toggle collapsed" data-toggle="collapse" data-bind="text:name, attr:{href:'#group'+$index()}"></a>
  </div>
  <div class="accordion-body collapse" data-bind="attr:{id:'group'+$index()}">
    <div class="accordion-inner " data-bind="template:{name:'ship', foreach: ships}">
    </div>
  </div>
</div>
</script>
<script type="text/html" id="ship">
<div class="ship" data-bind="click: $root.selectShip, css: $root.selectedShip() === $data ? 'active':''">
    <div class="row-fluid">
      <div class="span2">
        <img class="img-rounded" data-bind="attr:{src:image}" />
      </div>
      <div class="span8">
        <b data-bind="text:name"></b>
      </div>
      <div class="span2" data-bind="visible: $root.selectedShip() === $data ? true:false">
        <i class="icon-ok-sign icon-white pull-right"></i>
      </div>
    </div>
  </div>
</script>
<script type="text/javascript">
  evefits.fittings.create.init();
</script>